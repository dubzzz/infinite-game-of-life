var P=(n,e,i)=>{if(!e.has(n))throw TypeError("Cannot "+i)};var t=(n,e,i)=>(P(n,e,"read from private field"),i?i.call(n):e.get(n)),b=(n,e,i)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,i)},d=(n,e,i,s)=>(P(n,e,"write to private field"),s?s.call(n,i):e.set(n,i),i);var _=(n,e,i)=>(P(n,e,"access private method"),i);var c,y,r,w,Y,U,I,q,M,k,D,J;(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();let l;const F=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&F.decode();let R=null;function Q(){return(R===null||R.byteLength===0)&&(R=new Uint8Array(l.memory.buffer)),R}function N(n,e){return n=n>>>0,F.decode(Q().subarray(n,n+e))}let E=null;function V(){return(E===null||E.byteLength===0)&&(E=new Uint32Array(l.memory.buffer)),E}let T=0;function B(n,e){const i=e(n.length*4,4)>>>0;return V().set(n,i/4),T=n.length,i}let O=null;function j(){return(O===null||O.byteLength===0)&&(O=new Int32Array(l.memory.buffer)),O}const G=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>l.__wbg_universewasm_free(n>>>0));class z{static __wrap(e){e=e>>>0;const i=Object.create(z.prototype);return i.__wbg_ptr=e,G.register(i,i.__wbg_ptr,i),i}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,G.unregister(this),e}free(){const e=this.__destroy_into_raw();l.__wbg_universewasm_free(e)}static new(){const e=l.universewasm_new();return z.__wrap(e)}add(e,i){const s=l.universewasm_add(this.__wbg_ptr,e,i);return z.__wrap(s)}add_many(e,i){const s=B(e,l.__wbindgen_malloc),o=T,a=B(i,l.__wbindgen_malloc),h=T,f=l.universewasm_add_many(this.__wbg_ptr,s,o,a,h);return z.__wrap(f)}next(){const e=l.universewasm_next(this.__wbg_ptr);return z.__wrap(e)}window(e,i,s,o){let a,h;try{const v=l.__wbindgen_add_to_stack_pointer(-16);l.universewasm_window(v,this.__wbg_ptr,e,i,s,o);var f=j()[v/4+0],x=j()[v/4+1];return a=f,h=x,N(f,x)}finally{l.__wbindgen_add_to_stack_pointer(16),l.__wbindgen_free(a,h,1)}}}async function Z(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(s){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",s);else throw s}const i=await n.arrayBuffer();return await WebAssembly.instantiate(i,e)}else{const i=await WebAssembly.instantiate(n,e);return i instanceof WebAssembly.Instance?{instance:i,module:n}:i}}function $(){const n={};return n.wbg={},n.wbg.__wbindgen_throw=function(e,i){throw new Error(N(e,i))},n}function tt(n,e){return l=n.exports,H.__wbindgen_wasm_module=e,O=null,E=null,R=null,l}async function H(n){if(l!==void 0)return l;typeof n>"u"&&(n=new URL("https://dubzzz.github.io/infinite-game-of-life/assets/gol_engine_bg-CxC5UfhL.wasm",import.meta.url));const e=$();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:i,module:s}=await Z(await n,e);return tt(i,s)}const S=[[{x:0,y:0}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:2,y:0}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:1}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-2,y:1}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:0,y:1}],[{x:-1,y:-1},{x:-1,y:0},{x:0,y:-1},{x:0,y:1},{x:1,y:0}],[{x:-1,y:-1},{x:-1,y:0},{x:0,y:-1},{x:0,y:1},{x:1,y:0},{x:1,y:1}],[{x:-1,y:0},{x:0,y:-1},{x:-1,y:1},{x:1,y:-1},{x:0,y:2},{x:2,y:0},{x:1,y:1}],[{x:0,y:-1},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}]];class et{constructor(e){b(this,Y);b(this,I);b(this,M);b(this,D);b(this,c,void 0);b(this,y,void 0);b(this,r,void 0);b(this,w,void 0);d(this,c,document.createElement("canvas")),t(this,c).style.position="fixed",t(this,c).style.left="0",t(this,c).style.right="0",t(this,c).style.height="100vh",t(this,c).style.width="100vw",t(this,c).className="mode-move",e.appendChild(t(this,c)),_(this,Y,U).call(this),d(this,y,z.new()),d(this,y,t(this,y).add(10,10)),d(this,y,t(this,y).add(11,10)),d(this,y,t(this,y).add(12,10)),d(this,r,{x:0,y:0,zoom:20}),d(this,w,[]);let i=0,s;t(this,c).addEventListener("mousedown",o=>{if(o.button===0){if(d(this,w,[]),o.ctrlKey){const a=_(this,M,k).call(this,{x:o.clientX,y:o.clientY});for(const h of S[i])d(this,y,t(this,y).add(a.y+h.y,a.x+h.x));this.redrawScene(),s={mode:"draw"};return}if(o.altKey){const a=t(this,c).width,h=t(this,c).height,f=Math.floor(t(this,r).x/t(this,r).zoom),x=Math.ceil((t(this,r).x+a-1)/t(this,r).zoom),v=Math.floor(t(this,r).y/t(this,r).zoom),X=Math.ceil((t(this,r).y+h-1)/t(this,r).zoom),m=[],u=[];for(let g=v;g<=X;++g)for(let p=f;p<=x;++p)Math.random()<.25&&(u.push(p),m.push(g));d(this,y,t(this,y).add_many(Int32Array.from(m),Int32Array.from(u))),this.redrawScene()}s={mode:"move",initialOrigin:t(this,r),initialMousePosition:{x:o.clientX,y:o.clientY}}}}),t(this,c).addEventListener("mousemove",o=>{if(s===void 0){if(d(this,w,[]),o.ctrlKey){const a=_(this,M,k).call(this,{x:o.clientX,y:o.clientY});for(const h of S[i])t(this,w).push({x:a.x+h.x,y:a.y+h.y});this.redrawScene();return}return}switch(s.mode){case"move":{const a=o.clientX-s.initialMousePosition.x,h=o.clientY-s.initialMousePosition.y;d(this,r,{...t(this,r),x:s.initialOrigin.x-a,y:s.initialOrigin.y-h}),this.redrawScene();break}case"draw":{const a=_(this,M,k).call(this,{x:o.clientX,y:o.clientY});for(const h of S[i])d(this,y,t(this,y).add(a.y+h.y,a.x+h.x));this.redrawScene();break}}}),t(this,c).addEventListener("mouseup",o=>{o.button===0&&(s=void 0)}),t(this,c).addEventListener("wheel",o=>{o.preventDefault();const a=Math.sign(o.deltaY);if(o.ctrlKey&&s===void 0||(s==null?void 0:s.mode)==="draw"){i=(i+a+S.length)%S.length;const f=_(this,M,k).call(this,{x:o.clientX,y:o.clientY});for(const x of S[i])t(this,w).push({x:f.x+x.x,y:f.y+x.y});this.redrawScene();return}const h=Math.max(1,t(this,r).zoom-a);d(this,r,{x:h/t(this,r).zoom*(t(this,r).x+o.clientX)-o.clientX,y:h/t(this,r).zoom*(t(this,r).y+o.clientY)-o.clientY,zoom:h}),this.redrawScene()}),document.addEventListener("keyup",o=>{!o.ctrlKey&&t(this,w).length!==0&&(d(this,w,[]),this.redrawScene())}),new ResizeObserver(()=>{_(this,Y,U).call(this),this.redrawScene()}).observe(t(this,c)),_(this,I,q).call(this)}redrawScene(){const e=t(this,c).width,i=t(this,c).height,s=Math.floor(t(this,r).x/t(this,r).zoom),o=Math.ceil((t(this,r).x+e-1)/t(this,r).zoom)-s+1,a=Math.floor(t(this,r).y/t(this,r).zoom),h=Math.ceil((t(this,r).y+i-1)/t(this,r).zoom)-a+1,f=t(this,y).window(a,s,a+h-1,s+o-1),x=t(this,c).getContext("2d"),v=x.getImageData(0,0,e,i),X=(m,u,g)=>{for(let p=0;p!==t(this,r).zoom;++p){const W=m*t(this,r).zoom+p;if(!(W<0)){if(W>=i)break;for(let C=0;C!==t(this,r).zoom;++C){const K=u*t(this,r).zoom+C;if(K<0)continue;if(K>=e)break;const L=(K+W*e)*4,A=v.data;A[L+0]=0,A[L+1]=g(A[L+1]),A[L+2]=0,A[L+3]=255}}}};for(let m=0;m!==h;++m)for(let u=0;u!==o;++u){const g=u+m*o,p=f[g]==="*";X(m,u,()=>p?255:0)}for(const m of t(this,w)){const u=_(this,D,J).call(this,m);X(u.y,u.x,g=>Math.max(g,127))}x.putImageData(v,0,0)}}c=new WeakMap,y=new WeakMap,r=new WeakMap,w=new WeakMap,Y=new WeakSet,U=function(){const e=t(this,c).getBoundingClientRect();t(this,c).height=e.height,t(this,c).width=e.width},I=new WeakSet,q=function(){this.redrawScene(),setTimeout(()=>{d(this,y,t(this,y).next()),_(this,I,q).call(this)},250)},M=new WeakSet,k=function(e){const i=Math.floor((t(this,r).x+e.x)/t(this,r).zoom),s=Math.floor((t(this,r).y+e.y)/t(this,r).zoom);return{x:i,y:s}},D=new WeakSet,J=function(e){const i=e.x-Math.floor(t(this,r).x/t(this,r).zoom),s=e.y-Math.floor(t(this,r).y/t(this,r).zoom);return{x:i,y:s}};function nt(n){new et(n)}H().then(()=>nt(document.querySelector("#app")));
