var dt=(y,l)=>()=>(l||y((l={exports:{}}).exports,l),l.exports);var U=(y,l,h)=>{if(!l.has(y))throw TypeError("Cannot "+h)};var t=(y,l,h)=>(U(y,l,"read from private field"),h?h.call(y):l.get(y)),p=(y,l,h)=>{if(l.has(y))throw TypeError("Cannot add the same private member more than once");l instanceof WeakSet?l.add(y):l.set(y,h)},f=(y,l,h,K)=>(U(y,l,"write to private field"),K?K.call(y,h):l.set(y,h),h);var g=(y,l,h)=>(U(y,l,"access private method"),h);var yt=dt((ft,G)=>{(async()=>{var c,u,s,m,k,I,O,N,M,D,T,Q;(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const e of i)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const e={};return i.integrity&&(e.integrity=i.integrity),i.referrerPolicy&&(e.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?e.credentials="include":i.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(i){if(i.ep)return;i.ep=!0;const e=n(i);fetch(i.href,e)}})();const y="https://dubzzz.github.io/infinite-game-of-life/assets/gol_engine_bg-DQ3ZrjYK.wasm",l=async(d={},n)=>{let r;if(n.startsWith("data:")){const i=n.replace(/^data:.*?base64,/,"");let e;if(typeof Buffer=="function"&&typeof Buffer.from=="function")e=Buffer.from(i,"base64");else if(typeof atob=="function"){const o=atob(i);e=new Uint8Array(o.length);for(let a=0;a<o.length;a++)e[a]=o.charCodeAt(a)}else throw new Error("Cannot decode base64-encoded data URL");r=await WebAssembly.instantiate(e,d)}else{const i=await fetch(n),e=i.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&e.startsWith("application/wasm"))r=await WebAssembly.instantiateStreaming(i,d);else{const o=await i.arrayBuffer();r=await WebAssembly.instantiate(o,d)}}return r.instance.exports};let h;function K(d){h=d}const J=typeof TextDecoder>"u"?(0,G.require)("util").TextDecoder:TextDecoder;let q=new J("utf-8",{ignoreBOM:!0,fatal:!0});q.decode();let P=null;function V(){return(P===null||P.byteLength===0)&&(P=new Uint8Array(h.memory.buffer)),P}function F(d,n){return d=d>>>0,q.decode(V().subarray(d,d+n))}let R=null;function Z(){return(R===null||R.byteLength===0)&&(R=new Int32Array(h.memory.buffer)),R}const H=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(d=>h.__wbg_universewasm_free(d>>>0));class S{static __wrap(n){n=n>>>0;const r=Object.create(S.prototype);return r.__wbg_ptr=n,H.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){const n=this.__wbg_ptr;return this.__wbg_ptr=0,H.unregister(this),n}free(){const n=this.__destroy_into_raw();h.__wbg_universewasm_free(n)}static new(){const n=h.universewasm_new();return S.__wrap(n)}add(n,r){const i=h.universewasm_add(this.__wbg_ptr,n,r);return S.__wrap(i)}next(){const n=h.universewasm_next(this.__wbg_ptr);return S.__wrap(n)}window(n,r,i,e){let o,a;try{const z=h.__wbindgen_add_to_stack_pointer(-16);h.universewasm_window(z,this.__wbg_ptr,n,r,i,e);var b=Z()[z/4+0],x=Z()[z/4+1];return o=b,a=x,F(b,x)}finally{h.__wbindgen_add_to_stack_pointer(16),h.__wbindgen_free(o,a,1)}}}function $(d,n){throw new Error(F(d,n))}URL=globalThis.URL;const v=await l({"./gol_engine_bg.js":{__wbindgen_throw:$}},y),tt=v.memory,et=v.__wbg_universewasm_free,it=v.universewasm_new,st=v.universewasm_add,nt=v.universewasm_next,rt=v.universewasm_window,ot=v.__wbindgen_add_to_stack_pointer,at=v.__wbindgen_free,ht=Object.freeze(Object.defineProperty({__proto__:null,__wbg_universewasm_free:et,__wbindgen_add_to_stack_pointer:ot,__wbindgen_free:at,memory:tt,universewasm_add:st,universewasm_new:it,universewasm_next:nt,universewasm_window:rt},Symbol.toStringTag,{value:"Module"}));K(ht);const L=[[{x:0,y:0}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:2,y:0}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:1}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-2,y:1}],[{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:0,y:1}],[{x:-1,y:-1},{x:-1,y:0},{x:0,y:-1},{x:0,y:1},{x:1,y:0}],[{x:-1,y:-1},{x:-1,y:0},{x:0,y:-1},{x:0,y:1},{x:1,y:0},{x:1,y:1}],[{x:-1,y:0},{x:0,y:-1},{x:-1,y:1},{x:1,y:-1},{x:0,y:2},{x:2,y:0},{x:1,y:1}],[{x:0,y:-1},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}]];class ct{constructor(n){p(this,k);p(this,O);p(this,M);p(this,T);p(this,c,void 0);p(this,u,void 0);p(this,s,void 0);p(this,m,void 0);f(this,c,document.createElement("canvas")),t(this,c).style.position="fixed",t(this,c).style.left="0",t(this,c).style.right="0",t(this,c).style.height="100vh",t(this,c).style.width="100vw",t(this,c).className="mode-move",n.appendChild(t(this,c)),g(this,k,I).call(this),f(this,u,S.new()),f(this,u,t(this,u).add(10,10)),f(this,u,t(this,u).add(11,10)),f(this,u,t(this,u).add(12,10)),f(this,s,{x:0,y:0,zoom:20}),f(this,m,[]);let r=0,i;t(this,c).addEventListener("mousedown",e=>{if(e.button===0){if(f(this,m,[]),e.ctrlKey){const o=g(this,M,D).call(this,{x:e.clientX,y:e.clientY});for(const a of L[r])f(this,u,t(this,u).add(o.y+a.y,o.x+a.x));this.redrawScene(),i={mode:"draw"};return}if(e.altKey){const o=t(this,c).width,a=t(this,c).height,b=Math.floor(t(this,s).x/t(this,s).zoom),x=Math.ceil((t(this,s).x+o-1)/t(this,s).zoom),z=Math.floor(t(this,s).y/t(this,s).zoom),B=Math.ceil((t(this,s).y+a-1)/t(this,s).zoom);for(let w=z;w<=B;++w)for(let _=b;_<=x;++_)Math.random()<.25&&f(this,u,t(this,u).add(w,_));this.redrawScene()}i={mode:"move",initialOrigin:t(this,s),initialMousePosition:{x:e.clientX,y:e.clientY}}}}),t(this,c).addEventListener("mousemove",e=>{if(i===void 0){if(f(this,m,[]),e.ctrlKey){const o=g(this,M,D).call(this,{x:e.clientX,y:e.clientY});for(const a of L[r])t(this,m).push({x:o.x+a.x,y:o.y+a.y});this.redrawScene();return}return}switch(i.mode){case"move":{const o=e.clientX-i.initialMousePosition.x,a=e.clientY-i.initialMousePosition.y;f(this,s,{...t(this,s),x:i.initialOrigin.x-o,y:i.initialOrigin.y-a}),this.redrawScene();break}case"draw":{const o=g(this,M,D).call(this,{x:e.clientX,y:e.clientY});for(const a of L[r])f(this,u,t(this,u).add(o.y+a.y,o.x+a.x));this.redrawScene();break}}}),t(this,c).addEventListener("mouseup",e=>{e.button===0&&(i=void 0)}),t(this,c).addEventListener("wheel",e=>{e.preventDefault();const o=Math.sign(e.deltaY);if(e.ctrlKey&&i===void 0||(i==null?void 0:i.mode)==="draw"){r=(r+o+L.length)%L.length;const b=g(this,M,D).call(this,{x:e.clientX,y:e.clientY});for(const x of L[r])t(this,m).push({x:b.x+x.x,y:b.y+x.y});this.redrawScene();return}const a=Math.max(1,t(this,s).zoom-o);f(this,s,{x:a/t(this,s).zoom*(t(this,s).x+e.clientX)-e.clientX,y:a/t(this,s).zoom*(t(this,s).y+e.clientY)-e.clientY,zoom:a}),this.redrawScene()}),document.addEventListener("keyup",e=>{!e.ctrlKey&&t(this,m).length!==0&&(f(this,m,[]),this.redrawScene())}),new ResizeObserver(()=>{g(this,k,I).call(this),this.redrawScene()}).observe(t(this,c)),g(this,O,N).call(this)}redrawScene(){const n=t(this,c).width,r=t(this,c).height,i=Math.floor(t(this,s).x/t(this,s).zoom),e=Math.ceil((t(this,s).x+n-1)/t(this,s).zoom)-i+1,o=Math.floor(t(this,s).y/t(this,s).zoom),a=Math.ceil((t(this,s).y+r-1)/t(this,s).zoom)-o+1,b=t(this,u).window(o,i,o+a-1,i+e-1),x=t(this,c).getContext("2d"),z=x.getImageData(0,0,n,r),B=(w,_,Y)=>{for(let A=0;A!==t(this,s).zoom;++A){const C=w*t(this,s).zoom+A;if(!(C<0)){if(C>=r)break;for(let W=0;W!==t(this,s).zoom;++W){const j=_*t(this,s).zoom+W;if(j<0)continue;if(j>=n)break;const E=(j+C*n)*4,X=z.data;X[E+0]=0,X[E+1]=Y(X[E+1]),X[E+2]=0,X[E+3]=255}}}};for(let w=0;w!==a;++w)for(let _=0;_!==e;++_){const Y=_+w*e,A=b[Y]==="*";B(w,_,()=>A?255:0)}for(const w of t(this,m)){const _=g(this,T,Q).call(this,w);B(_.y,_.x,Y=>Math.max(Y,127))}x.putImageData(z,0,0)}}c=new WeakMap,u=new WeakMap,s=new WeakMap,m=new WeakMap,k=new WeakSet,I=function(){const n=t(this,c).getBoundingClientRect();t(this,c).height=n.height,t(this,c).width=n.width},O=new WeakSet,N=function(){this.redrawScene(),setTimeout(()=>{f(this,u,t(this,u).next()),g(this,O,N).call(this)},250)},M=new WeakSet,D=function(n){const r=Math.floor((t(this,s).x+n.x)/t(this,s).zoom),i=Math.floor((t(this,s).y+n.y)/t(this,s).zoom);return{x:r,y:i}},T=new WeakSet,Q=function(n){const r=n.x-Math.floor(t(this,s).x/t(this,s).zoom),i=n.y-Math.floor(t(this,s).y/t(this,s).zoom);return{x:r,y:i}};function lt(d){new ct(d)}lt(document.querySelector("#app"))})()});export default yt();
